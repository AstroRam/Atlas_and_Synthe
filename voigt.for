PROGRAM ATLAS12

      REAL*4 EXTAB,EXTABF,E1TAB,H0TAB,H1TAB,H2TAB,VSTEPS

      SUBROUTINE TABVOIGT(VSTEPS,N)
      COMMON /H1TAB/H0TAB(2001),H1TAB(2001),H2TAB(2001)
      DIMENSION TABVI(81),TABH1(81)
      DATA TABVI/0.,.1,.2,.3,.4,.5,.6,.7,.8,.9,1.,1.1,1.2,1.3,1.4,1.5,
     11.6,1.7,1.8,1.9,2.,2.1,2.2,2.3,2.4,2.5,2.6,2.7,2.8,2.9,3.,3.1,3.2,
     2 3.3,3.4,3.5,3.6,3.7,3.8,3.9,4.0,4.2,4.4,4.6,4.8,5.0,5.2,5.4,5.6,
     3 5.8,6.0,6.2,6.4,6.6,6.8,7.0,7.2,7.4,7.6,7.8,8.0,8.2,8.4,8.6,8.8,
     4 9.0,9.2,9.4,9.6,9.8,10.0,10.2,10.4,10.6,10.8,11.0,11.2,11.4,11.6,
     5 11.8,12.0/
      DATA TABH1/-1.12838,-1.10596,-1.04048,-.93703,-.80346,-.64945,
     1-.48552,-.32192,-.16772,-.03012,.08594,.17789,.24537,.28981,
     2.31394,.32130,.31573,.30094,.28027,.25648,.231726,.207528,.184882,
     3.164341,.146128,.130236,.116515,.104739,.094653,.086005,.078565,
     4 .072129,.066526,.061615,.057281,.053430,.049988,.046894,.044098,
     5 .041561,.039250,.035195,.031762,.028824,.026288,.024081,.022146,
     6 .020441,.018929,.017582,.016375,.015291,.014312,.013426,.012620,
     7 .0118860,.0112145,.0105990,.0100332,.0095119,.0090306,.0085852,
     8 .0081722,.0077885,.0074314,.0070985,.0067875,.0064967,.0062243,
     9 .0059688,.0057287,.0055030,.0052903,.0050898,.0049006,.0047217,
     T .0045526,.0043924,.0042405,.0040964,.0039595/
C     PRETABULATE VOIGT FUNCTION
C     100 STEPS PER DOPPLER WIDTH GIVES 2 PER CENT ACCURACY
      DO 1 I=1,N
    1 H0TAB(I)=FLOAT(I-1)/VSTEPS
c      CALL MAP4(TABVI,TABH1,81,H0TAB,H1TAB,N)
      IDUM=MAP4(TABVI,TABH1,81,H0TAB,H1TAB,N)
      DO 2 I=1,N
      VV=(FLOAT(I-1)/VSTEPS)**2
      H0TAB(I)=EXP(-VV)
    2 H2TAB(I)=H0TAB(I)-(VV+VV)*H0TAB(I)
      RETURN

End
